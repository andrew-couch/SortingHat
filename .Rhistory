library(tidyverse)
library(doParallel)
library(caret)
df <- readRDS("harrypotter.rds")
df <- df %>% select(-character)
df$TargetHouse <- as.factor(df$TargetHouse)
modelData <- upSample(df %>% select(-TargetHouse), df$TargetHouse)
setwd("E:/School/R Work/SortingHat")
library(tidyverse)
library(doParallel)
library(caret)
df <- readRDS("harrypotter.rds")
df <- df %>% select(-character)
df$TargetHouse <- as.factor(df$TargetHouse)
modelData <- upSample(df %>% select(-TargetHouse), df$TargetHouse)
cl <- makePSOCKcluster(7)
registerDoParallel(cl)
PCACenterScaleL1BaseLineModel <- train(Class~.,
data = modelData,
method = "glmnet",
preProc = c("center","scale", "pca"),
tuneGrid = expand.grid(alpha = 1,
lambda = 10^seq(-3,3, length = 100)),
trControl = trainControl(method = "repeatedcv",
repeats = 10,
number = 10))
PCACenterScaleL2BaseLineModel <- train(Class~.,
data = modelData,
method = "glmnet",
preProc = c("center","scale", "pca"),
tuneGrid = expand.grid(alpha = 0,
lambda = 10^seq(-3,3, length = 100)),
trControl = trainControl(method = "repeatedcv",
repeats = 10,
number = 10))
PCABoxCoxElasticNetModel <- train(Class~.,
data = modelData,
method = "glmnet",
preProc = c("BoxCox", "pca"),
tuneLength = 20,
trControl = trainControl(method = "repeatedcv",
repeats = 10,
number = 10))
BaseLineCenterScaleL1BaseLineModel <- train(Class~.,
data = modelData,
method = "glmnet",
preProc = c("center","scale", "pca"),
tuneGrid = expand.grid(alpha = 1,
lambda = 10^seq(-3,3, length = 100)),
trControl = trainControl(method = "repeatedcv",
repeats = 10,
number = 10))
BaseLineCenterScaleL2BaseLineModel <- train(Class~.,
data = modelData,
method = "glmnet",
preProc = c("center","scale", "pca"),
tuneGrid = expand.grid(alpha = 0,
lambda = 10^seq(-3,3, length = 100)),
trControl = trainControl(method = "repeatedcv",
repeats = 10,
number = 10))
BaseLineBoxCoxElasticNetModel <- train(Class~.,
data = modelData,
method = "glmnet",
preProc = c("BoxCox", "pca"),
tuneLength = 20,
trControl = trainControl(method = "repeatedcv",
repeats = 10,
number = 10))
stopCluster(cl)
FinalL1Comp <- resamples(list("PCA" = PCACenterScaleL1BaseLineModel, "L1" = BaseLineCenterScaleL1BaseLineModel))
FinalL2Comp <- resamples(list("PCA" = PCACenterScaleL2BaseLineModel, "L2" = BaseLineCenterScaleL2BaseLineModel))
FinalElasticComp <- resamples(list("PCA" = PCABoxCoxElasticNetModel, "Elastic" = BaseLineBoxCoxElasticNetModel))
summarise(FinalL1Comp)
summary(FinalL1Comp)
summary(FinalL2Comp)
summary(FinalElasticComp)
BaseLineBoxCoxElasticNetModel
BaseLineCenterScaleL1BaseLineModel
BaseLineCenterScaleL2BaseLineModel
varImp(BaseLineCenterScaleL1BaseLineModel)
cl <- makePSOCKcluster(7)
registerDoParallel(cl)
BaseLineCenterScaleL1BaseLineModel <- train(Class~.,
data = modelData,
method = "glmnet",
preProc = c("center","scale"),
tuneGrid = expand.grid(alpha = 1,
lambda = 10^seq(-3,3, length = 100)),
trControl = trainControl(method = "repeatedcv",
repeats = 10,
number = 10))
BaseLineCenterScaleL2BaseLineModel <- train(Class~.,
data = modelData,
method = "glmnet",
preProc = c("center","scale"),
tuneGrid = expand.grid(alpha = 0,
lambda = 10^seq(-3,3, length = 100)),
trControl = trainControl(method = "repeatedcv",
repeats = 10,
number = 10))
BaseLineBoxCoxElasticNetModel <- train(Class~.,
data = modelData,
method = "glmnet",
preProc = c("BoxCox"),
tuneLength = 20,
trControl = trainControl(method = "repeatedcv",
repeats = 10,
number = 10))
stopCluster(cl)
FinalL1Comp <- resamples(list("PCA" = PCACenterScaleL1BaseLineModel, "L1" = BaseLineCenterScaleL1BaseLineModel))
FinalL2Comp <- resamples(list("PCA" = PCACenterScaleL2BaseLineModel, "L2" = BaseLineCenterScaleL2BaseLineModel))
FinalElasticComp <- resamples(list("PCA" = PCABoxCoxElasticNetModel, "Elastic" = BaseLineBoxCoxElasticNetModel))
summary(FinalL1Comp)
summary(FinalL2Comp)
summary(FinalElasticComp)
BaseLineCenterScaleL1BaseLineModel %>% predict(df) %>% cbind(df$TargetHouse)
L1Test <- BaseLineCenterScaleL1BaseLineModel %>% predict(df) %>% cbind(df$TargetHouse)
BaseLineCenterScaleL2BaseLineModel %>% predict(df) %>% cbind(df$TargetHouse)
L2Test <- BaseLineCenterScaleL2BaseLineModel %>% predict(df) %>% cbind(df$TargetHouse)
ElasticTest <- BaseLineBoxCoxElasticNetModel %>% predict(df) %>% cbind(df$TargetHouse)
L1Test <- BaseLineCenterScaleL1BaseLineModel %>% predict(df) %>% cbind(df$TargetHouse) %>% as.data.frame()
L2Test <- BaseLineCenterScaleL2BaseLineModel %>% predict(df) %>% cbind(df$TargetHouse) %>% as.data.frame()
ElasticTest <- BaseLineBoxCoxElasticNetModel %>% predict(df) %>% cbind(df$TargetHouse) %>% as.data.frame()
View(L1Test)
BaseLineCenterScaleL1BaseLineModel %>% predict(df) %>% cbind(df$TargetHouse) %>% as.data.frame() %>% colnames()
BaseLineCenterScaleL1BaseLineModel %>% predict(df) %>% cbind(df$TargetHouse) %>% as.data.frame() %>% rename("Prediction" = ., "Actual" = V2)
BaseLineCenterScaleL1BaseLineModel %>% predict(df) %>% cbind(df$TargetHouse) %>% as.data.frame() %>% rename(.,"Prediction" = ., "Actual" = V2)
L1Test <- BaseLineCenterScaleL1BaseLineModel %>%
predict(df) %>%
cbind(df$TargetHouse) %>%
as.data.frame() %>%
rename(.,"Prediction" = ., "Actual" = V2) %>%
mutate(Correct = if_else(Prediction == Actual, "Correct", "Wrong"))
L2Test <- BaseLineCenterScaleL2BaseLineModel %>%
predict(df) %>%
cbind(df$TargetHouse) %>%
as.data.frame() %>%
rename(.,"Prediction" = ., "Actual" = V2) %>%
mutate(Correct = if_else(Prediction == Actual, "Correct", "Wrong"))
ElasticTest <- BaseLineBoxCoxElasticNetModel %>%
predict(df) %>%
cbind(df$TargetHouse) %>%
as.data.frame() %>%
rename(.,"Prediction" = ., "Actual" = V2) %>%
mutate(Correct = if_else(Prediction == Actual, "Correct", "Wrong"))
L1Test
L1Test %>% filter(Correct == "Correct") %>% nrow() / nrow(df)
L1Test %>% filter(Correct == "Correct") %>% nrow() / nrow(df)
L2Test %>% filter(Correct == "Correct") %>% nrow() / nrow(df)
ElasticTest %>% filter(Correct == "Correct") %>% nrow() / nrow(df)
BaseLineBoxCoxElasticNetModel
L1Test %>% filter(Correct == "Correct") %>% nrow() / nrow(df)
L2Test %>% filter(Correct == "Correct") %>% nrow() / nrow(df)
ElasticTest %>% filter(Correct == "Correct") %>% nrow() / nrow(df)
saveRDS(BaseLineCenterScaleL1BaseLineModel, "L1Model.rds")
saveRDS(BaseLineCenterScaleL2BaseLineModel, "L2Model.rds")
saveRDS(BaseLineBoxCoxElasticNetModel, "ElasticNetModel.rds")
readRDS("L1Model.rds")
regComp <- resamples(list("L1" = BaseLineCenterScaleL1BaseLineModel, "L2" = BaseLineCenterScaleL2BaseLineModel, "ELastic Net" = BaseLineBoxCoxElasticNetModel))
ggplot(regComp)
ggplot(BaseLineBoxCoxElasticNetModel)
plot(BaseLineBoxCoxElasticNetModel)
plot(BaseLineCenterScaleL1BaseLineModel)
plot(regComp)
bwplot(regComp)
summarise(regComp)
summary(regComp)
