library(tidyverse)
library(caret)
library(doParallel)
library(beepr)
df <- readRDS("harrypotter.rds")
df <- df %>% select(-character)
df$TargetHouse <- as.factor(df$TargetHouse)
modelData <- upSample(x = df %>% select(-TargetHouse), y = df$TargetHouse)
testAccuracy <- function (model) {
model %>%
predict(df) %>%
cbind(df$TargetHouse) %>%
as.data.frame() %>%
rename(., "Predicted" = ., "Actual" = V2) %>%
mutate(Correct = if_else(Actual == Predicted, "Correct", "Wrong")) %>%
filter(Correct == "Correct") %>%
nrow() / nrow(df)
}
setwd("E:/School/R Work/SortingHat")
df <- readRDS("harrypotter.rds")
df <- df %>% select(-character)
df$TargetHouse <- as.factor(df$TargetHouse)
modelData <- upSample(x = df %>% select(-TargetHouse), y = df$TargetHouse)
testAccuracy <- function (model) {
model %>%
predict(df) %>%
cbind(df$TargetHouse) %>%
as.data.frame() %>%
rename(., "Predicted" = ., "Actual" = V2) %>%
mutate(Correct = if_else(Actual == Predicted, "Correct", "Wrong")) %>%
filter(Correct == "Correct") %>%
nrow() / nrow(df)
}
cl <- makePSOCKcluster(7)
registerDoParallel(cl)
baseLineModel <- train(Class~.,
data = modelData,
method = "bayesglm")
beep(3)
stopCluster(cl)
baseLineModel
saveRDS(baseLineModel, "LogisticRegressionModel.rds")
